<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>APEX Â· Rendimiento Integral</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%230A1628'/%3E%3Cpath d='M32 8 L56 52 H40 L32 36 L24 52 H8 Z' fill='%2300C2FF'/%3E%3Cpath d='M32 20 L44 44 H36 L32 36 L28 44 H20 Z' fill='%237C3AED'/%3E%3C/svg%3E">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300&family=Syne:wght@700;800&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN TOKENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:        #060D1A;
  --bg2:       #0A1628;
  --bg3:       #0F1F38;
  --panel:     rgba(255,255,255,0.04);
  --panel2:    rgba(255,255,255,0.07);

  --blue:      #00C2FF;
  --blue-dark: #0088CC;
  --blue-glow: rgba(0,194,255,0.18);
  --green:     #00E676;
  --green-dark:#00A855;
  --green-glow:rgba(0,230,118,0.15);
  --purple:    #7C3AED;
  --purple-light:#A855F7;
  --purple-glow:rgba(124,58,237,0.2);
  --red:       #FF4757;
  --yellow:    #FFD60A;

  --text:      #E8F0FE;
  --text-muted:#7A8BA8;
  --border:    rgba(255,255,255,0.08);
  --border-active: rgba(0,194,255,0.4);
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{
  font-family:'DM Sans',sans-serif;
  background:var(--bg);color:var(--text);
  overflow-x:hidden;min-height:100vh;
  line-height:1.6;
}

/* SCROLLBAR */
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:var(--bg)}
::-webkit-scrollbar-thumb{background:var(--blue-dark);border-radius:3px}

/* GRID BACKGROUND */
body::after{
  content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background-image:
    linear-gradient(rgba(0,194,255,0.03) 1px,transparent 1px),
    linear-gradient(90deg,rgba(0,194,255,0.03) 1px,transparent 1px);
  background-size:60px 60px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.screen{display:none;position:relative;z-index:1;min-height:100vh;animation:fadeIn 0.45s ease}
.screen.active{display:flex;flex-direction:column}
@keyframes fadeIn{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:none}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOPBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.topbar{
  position:fixed;top:0;left:0;right:0;z-index:300;
  display:flex;align-items:center;gap:1rem;
  padding:0 2rem;height:56px;
  background:rgba(6,13,26,0.92);
  backdrop-filter:blur(16px);
  border-bottom:1px solid var(--border);
}
.topbar-logo{
  font-family:'Bebas Neue',sans-serif;
  font-size:1.5rem;letter-spacing:0.2em;
  background:linear-gradient(90deg,var(--blue),var(--purple-light));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  flex-shrink:0;cursor:pointer;
}
.topbar-sep{flex:1}
.topbar-nav{display:flex;gap:0.25rem}
.topbar-nav button{
  background:none;border:none;
  padding:0.4rem 0.9rem;border-radius:6px;
  font-family:'DM Sans',sans-serif;font-size:0.8rem;
  letter-spacing:0.05em;color:var(--text-muted);
  cursor:pointer;transition:all 0.2s;
}
.topbar-nav button:hover{color:var(--text);background:var(--panel)}
.topbar-nav button.active-nav{color:var(--blue);background:rgba(0,194,255,0.08)}
.topbar-auth{display:flex;gap:0.5rem;align-items:center}
.topbar-user{
  display:flex;align-items:center;gap:0.5rem;
  font-size:0.82rem;color:var(--text-muted);
}
.topbar-avatar{
  width:28px;height:28px;border-radius:50%;
  background:linear-gradient(135deg,var(--blue),var(--purple));
  display:flex;align-items:center;justify-content:center;
  font-size:0.7rem;font-weight:700;color:white;flex-shrink:0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;
  padding:0.65rem 1.5rem;border-radius:8px;
  font-family:'DM Sans',sans-serif;font-weight:600;font-size:0.85rem;
  letter-spacing:0.04em;border:none;cursor:pointer;transition:all 0.22s;
  white-space:nowrap;
}
.btn-blue{background:var(--blue);color:var(--bg)}
.btn-blue:hover{background:#22CCFF;box-shadow:0 0 20px var(--blue-glow);transform:translateY(-1px)}
.btn-green{background:var(--green);color:var(--bg)}
.btn-green:hover{background:#33FFAA;box-shadow:0 0 20px var(--green-glow);transform:translateY(-1px)}
.btn-purple{background:var(--purple);color:white}
.btn-purple:hover{background:var(--purple-light);box-shadow:0 0 20px var(--purple-glow);transform:translateY(-1px)}
.btn-outline{background:transparent;color:var(--blue);border:1px solid var(--blue-dark)}
.btn-outline:hover{background:rgba(0,194,255,0.08)}
.btn-ghost{background:var(--panel);color:var(--text-muted);border:1px solid var(--border)}
.btn-ghost:hover{background:var(--panel2);color:var(--text)}
.btn-sm{padding:0.4rem 1rem;font-size:0.78rem}
.btn-lg{padding:0.85rem 2.2rem;font-size:0.95rem}
.btn-full{width:100%}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORM ELEMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.field{margin-bottom:1.1rem}
.field label{
  display:block;font-size:0.74rem;letter-spacing:0.15em;
  text-transform:uppercase;color:var(--text-muted);margin-bottom:0.45rem;
}
.field label span{color:var(--blue);margin-left:2px}
.field input,.field select,.field textarea{
  width:100%;padding:0.7rem 1rem;
  background:var(--panel2);border:1px solid var(--border);
  border-radius:8px;color:var(--text);
  font-family:'DM Sans',sans-serif;font-size:0.93rem;
  transition:border-color 0.2s,background 0.2s;
}
.field input:focus,.field select:focus,.field textarea:focus{
  outline:none;border-color:var(--blue);
  background:rgba(0,194,255,0.05);
}
.field select option{background:var(--bg2)}
.field textarea{resize:vertical;min-height:80px;line-height:1.6}

.scale-row{display:flex;gap:0.4rem}
.scale-btn{
  flex:1;padding:0.55rem 0;border-radius:6px;
  background:var(--panel);border:1px solid var(--border);
  color:var(--text-muted);font-size:0.85rem;font-weight:600;
  cursor:pointer;transition:all 0.18s;text-align:center;
}
.scale-btn:hover{border-color:var(--blue);color:var(--blue)}
.scale-btn.sel{background:var(--blue);color:var(--bg);border-color:var(--blue)}
.scale-labels{display:flex;justify-content:space-between;margin-top:0.25rem}
.scale-labels span{font-size:0.68rem;color:var(--text-muted)}

.check-group{display:flex;flex-direction:column;gap:0.45rem}
.check-item{
  display:flex;align-items:center;gap:0.7rem;
  padding:0.6rem 0.9rem;
  background:var(--panel);border:1px solid var(--border);
  border-radius:8px;cursor:pointer;transition:all 0.18s;
}
.check-item:hover{border-color:var(--blue-dark);background:var(--panel2)}
.check-item.sel{border-color:var(--blue);background:rgba(0,194,255,0.07)}
.check-item .chk{
  width:17px;height:17px;border:2px solid var(--border);
  border-radius:4px;display:flex;align-items:center;justify-content:center;
  font-size:0.65rem;flex-shrink:0;transition:all 0.18s;
}
.check-item.sel .chk{background:var(--blue);border-color:var(--blue);color:var(--bg)}
.check-item span{font-size:0.88rem;color:var(--text-muted)}
.check-item.sel span{color:var(--text)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CARDS / PANELS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card{
  background:var(--panel);border:1px solid var(--border);
  border-radius:12px;padding:1.5rem;
}
.card-glow-blue{border-color:rgba(0,194,255,0.25);box-shadow:0 0 30px rgba(0,194,255,0.06)}
.card-glow-green{border-color:rgba(0,230,118,0.25);box-shadow:0 0 30px rgba(0,230,118,0.06)}
.card-glow-purple{border-color:rgba(124,58,237,0.25);box-shadow:0 0 30px rgba(124,58,237,0.06)}

.badge{
  display:inline-flex;align-items:center;gap:0.35rem;
  padding:0.25rem 0.7rem;border-radius:100px;
  font-size:0.72rem;letter-spacing:0.08em;font-weight:600;
}
.badge-blue{background:rgba(0,194,255,0.12);color:var(--blue);border:1px solid rgba(0,194,255,0.25)}
.badge-green{background:rgba(0,230,118,0.12);color:var(--green);border:1px solid rgba(0,230,118,0.25)}
.badge-purple{background:rgba(124,58,237,0.12);color:var(--purple-light);border:1px solid rgba(124,58,237,0.25)}
.badge-red{background:rgba(255,71,87,0.12);color:var(--red);border:1px solid rgba(255,71,87,0.25)}

.section-label{
  font-size:0.72rem;letter-spacing:0.3em;text-transform:uppercase;
  color:var(--blue);margin-bottom:0.6rem;display:block;
}
.section-title{
  font-family:'Syne',sans-serif;font-weight:800;
  font-size:clamp(1.8rem,3.5vw,2.8rem);
  color:var(--text);line-height:1.1;
}
.section-title .accent{color:var(--blue)}
.section-title .accent-g{color:var(--green)}
.section-title .accent-p{color:var(--purple-light)}
.divider{width:40px;height:3px;border-radius:2px;margin:1rem 0}
.divider-blue{background:linear-gradient(90deg,var(--blue),transparent)}
.divider-green{background:linear-gradient(90deg,var(--green),transparent)}

.page-wrap{max-width:900px;margin:0 auto;padding:7rem 1.5rem 4rem;width:100%}
.page-wrap-wide{max-width:1100px;margin:0 auto;padding:7rem 1.5rem 4rem;width:100%}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast{
  position:fixed;bottom:2rem;left:50%;
  transform:translateX(-50%) translateY(120px);
  padding:0.7rem 1.4rem;border-radius:100px;
  font-size:0.83rem;font-weight:600;z-index:999;
  transition:transform 0.35s cubic-bezier(0.34,1.56,0.64,1);
  pointer-events:none;
}
.toast.show{transform:translateX(-50%) translateY(0)}
.toast-success{background:var(--green);color:var(--bg)}
.toast-error{background:var(--red);color:white}
.toast-info{background:var(--blue);color:var(--bg)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRESS BARS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.prog-track{height:6px;background:var(--panel2);border-radius:3px;overflow:hidden}
.prog-fill{height:100%;border-radius:3px;transition:width 0.6s ease}
.prog-blue{background:linear-gradient(90deg,var(--blue-dark),var(--blue))}
.prog-green{background:linear-gradient(90deg,var(--green-dark),var(--green))}
.prog-purple{background:linear-gradient(90deg,var(--purple),var(--purple-light))}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: HOME â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#screen-home{padding:0}

/* HERO */
.home-hero{
  min-height:100vh;display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  text-align:center;padding:7rem 2rem 5rem;
  background:
    radial-gradient(ellipse 70% 60% at 50% -10%,rgba(0,194,255,0.12) 0%,transparent 70%),
    radial-gradient(ellipse 50% 40% at 80% 90%,rgba(124,58,237,0.14) 0%,transparent 70%),
    radial-gradient(ellipse 40% 50% at 10% 80%,rgba(0,230,118,0.08) 0%,transparent 60%);
  position:relative;
}
.hero-eyebrow{
  font-size:0.72rem;letter-spacing:0.4em;text-transform:uppercase;
  color:var(--blue);margin-bottom:1.5rem;
  animation:fadeIn 0.5s ease 0.1s both;
}
.hero-h1{
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(4.5rem,12vw,10rem);
  letter-spacing:0.06em;line-height:0.88;
  animation:fadeIn 0.5s ease 0.2s both;
}
.hero-h1 .line1{
  background:linear-gradient(90deg,var(--blue),#88E4FF);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.hero-h1 .line2{
  background:linear-gradient(90deg,var(--purple-light),var(--blue));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.hero-sub{
  font-size:1.1rem;color:var(--text-muted);
  max-width:540px;margin:1.5rem auto 0;line-height:1.7;
  animation:fadeIn 0.5s ease 0.3s both;
}
.hero-sub strong{color:var(--text)}
.hero-pills{
  display:flex;gap:0.75rem;justify-content:center;flex-wrap:wrap;
  margin:2rem 0;animation:fadeIn 0.5s ease 0.4s both;
}
.hero-cta{
  display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;
  animation:fadeIn 0.5s ease 0.5s both;
}
.hero-disclaimer{
  margin-top:2rem;padding:0.8rem 1.4rem;
  background:rgba(255,71,87,0.07);border:1px solid rgba(255,71,87,0.2);
  border-radius:10px;font-size:0.78rem;color:rgba(232,240,254,0.55);
  max-width:520px;line-height:1.5;
  animation:fadeIn 0.5s ease 0.6s both;
}
.hero-disclaimer strong{color:var(--red)}

/* STATS STRIP */
.stats-strip{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:1px;background:var(--border);
}
.stat-cell{
  background:var(--bg2);padding:2rem 1.5rem;text-align:center;
}
.stat-num{
  font-family:'Bebas Neue',sans-serif;font-size:2.8rem;letter-spacing:0.04em;
}
.stat-num.blue{color:var(--blue)}
.stat-num.green{color:var(--green)}
.stat-num.purple{color:var(--purple-light)}
.stat-num.yellow{color:var(--yellow)}
.stat-lbl{font-size:0.75rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-muted);margin-top:0.2rem}

/* BLOG SECTION */
.blog-section{
  padding:5rem 2rem;
  background:linear-gradient(180deg,var(--bg2) 0%,var(--bg) 100%);
}
.blog-inner{max-width:1100px;margin:0 auto}
.blog-header{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:2.5rem;flex-wrap:wrap;gap:1rem}
.blog-grid{display:grid;grid-template-columns:1.4fr 1fr 1fr;gap:1.5rem}
.blog-card{
  background:var(--panel);border:1px solid var(--border);
  border-radius:14px;overflow:hidden;
  transition:transform 0.25s,border-color 0.25s,box-shadow 0.25s;
  cursor:pointer;
}
.blog-card:hover{transform:translateY(-4px);border-color:var(--blue-dark);box-shadow:0 12px 40px rgba(0,0,0,0.3)}
.blog-card-img{
  height:160px;display:flex;align-items:center;justify-content:center;
  font-size:3rem;
  position:relative;overflow:hidden;
}
.blog-card-img.physical{background:linear-gradient(135deg,rgba(0,194,255,0.15),rgba(0,230,118,0.1))}
.blog-card-img.mental{background:linear-gradient(135deg,rgba(124,58,237,0.2),rgba(0,194,255,0.1))}
.blog-card-img.sleep{background:linear-gradient(135deg,rgba(124,58,237,0.15),rgba(255,214,10,0.08))}
.blog-card-img.nutrition{background:linear-gradient(135deg,rgba(0,230,118,0.15),rgba(0,194,255,0.08))}
.blog-card.featured .blog-card-img{height:220px;font-size:4.5rem}
.blog-body{padding:1.2rem}
.blog-cat{font-size:0.68rem;letter-spacing:0.2em;text-transform:uppercase;font-weight:600;margin-bottom:0.5rem}
.blog-cat.phy{color:var(--blue)}
.blog-cat.men{color:var(--purple-light)}
.blog-cat.slp{color:var(--yellow)}
.blog-cat.nut{color:var(--green)}
.blog-title{font-family:'Syne',sans-serif;font-weight:700;font-size:1rem;color:var(--text);line-height:1.3;margin-bottom:0.5rem}
.blog-card.featured .blog-title{font-size:1.25rem}
.blog-excerpt{font-size:0.82rem;color:var(--text-muted);line-height:1.55}
.blog-meta{display:flex;align-items:center;gap:0.5rem;margin-top:0.9rem;font-size:0.72rem;color:var(--text-muted)}
.blog-dot{width:4px;height:4px;border-radius:50%;background:var(--text-muted)}

/* DATA SECTION */
.data-section{padding:5rem 2rem;background:var(--bg)}
.data-inner{max-width:1100px;margin:0 auto}
.data-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem;margin-top:2.5rem}
.data-card{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:14px;padding:1.8rem;
  position:relative;overflow:hidden;
}
.data-card::before{
  content:'';position:absolute;top:-30px;right:-30px;
  width:100px;height:100px;border-radius:50%;
  opacity:0.07;
}
.data-card.dc-blue::before{background:var(--blue)}
.data-card.dc-green::before{background:var(--green)}
.data-card.dc-purple::before{background:var(--purple)}
.data-icon{font-size:2rem;margin-bottom:1rem}
.data-headline{
  font-family:'Bebas Neue',sans-serif;font-size:2.2rem;letter-spacing:0.04em;
  line-height:1;margin-bottom:0.4rem;
}
.data-headline.blue{color:var(--blue)}
.data-headline.green{color:var(--green)}
.data-headline.purple{color:var(--purple-light)}
.data-desc{font-size:0.85rem;color:var(--text-muted);line-height:1.55}
.data-source{font-size:0.68rem;color:rgba(122,139,168,0.5);margin-top:0.75rem;letter-spacing:0.05em}

/* CTA SECTION */
.cta-section{
  padding:5rem 2rem;
  background:linear-gradient(135deg,rgba(0,194,255,0.06) 0%,rgba(124,58,237,0.1) 100%);
  border-top:1px solid var(--border);border-bottom:1px solid var(--border);
  text-align:center;
}
.cta-inner{max-width:640px;margin:0 auto}

/* FOOTER */
.home-footer{
  padding:2.5rem 2rem;background:var(--bg2);
  border-top:1px solid var(--border);text-align:center;
}
.home-footer p{font-size:0.78rem;color:var(--text-muted)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: AUTH â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#screen-auth{
  align-items:center;justify-content:center;
  padding:7rem 1.5rem 3rem;
  background:radial-gradient(ellipse 60% 50% at 50% 0%,rgba(0,194,255,0.08) 0%,transparent 70%);
}
.auth-box{
  width:100%;max-width:420px;
  background:var(--bg2);border:1px solid var(--border);
  border-radius:16px;padding:2.5rem;
}
.auth-logo{
  font-family:'Bebas Neue',sans-serif;font-size:2rem;
  letter-spacing:0.2em;text-align:center;margin-bottom:0.25rem;
  background:linear-gradient(90deg,var(--blue),var(--purple-light));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.auth-subtitle{text-align:center;font-size:0.83rem;color:var(--text-muted);margin-bottom:2rem}
.auth-tabs{display:flex;margin-bottom:1.5rem;background:var(--panel);border-radius:8px;padding:3px;gap:3px}
.auth-tab{
  flex:1;padding:0.5rem;border-radius:6px;border:none;
  background:transparent;color:var(--text-muted);
  font-family:'DM Sans',sans-serif;font-size:0.85rem;font-weight:600;
  cursor:pointer;transition:all 0.2s;
}
.auth-tab.active{background:var(--bg3);color:var(--text)}
.auth-error{
  padding:0.65rem 0.9rem;background:rgba(255,71,87,0.1);
  border:1px solid rgba(255,71,87,0.3);border-radius:8px;
  font-size:0.82rem;color:var(--red);margin-bottom:1rem;display:none;
}
.auth-sep{text-align:center;font-size:0.75rem;color:var(--text-muted);margin:0.75rem 0}
.auth-back{
  text-align:center;margin-top:1rem;
  font-size:0.8rem;color:var(--text-muted);
}
.auth-back a{color:var(--blue);cursor:pointer;text-decoration:none}
.auth-back a:hover{text-decoration:underline}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: FORM â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.form-section-hdr{
  font-family:'Syne',sans-serif;font-weight:700;font-size:0.9rem;
  color:var(--blue);border-bottom:1px solid var(--border);
  padding-bottom:0.5rem;margin:1.5rem 0 1.1rem;
  display:flex;align-items:center;gap:0.5rem;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: LOADING â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#screen-loading{align-items:center;justify-content:center;text-align:center;padding:2rem}
.loader-ring{
  width:72px;height:72px;border-radius:50%;
  border:3px solid var(--panel2);
  border-top-color:var(--blue);
  animation:spin 0.9s linear infinite;
  margin:0 auto 1.5rem;
}
@keyframes spin{to{transform:rotate(360deg)}}
.loader-title{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;letter-spacing:0.12em;color:var(--text)}
.loader-sub{font-size:0.83rem;color:var(--text-muted);margin-top:0.4rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: ROUTINE â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.routine-hdr{margin-bottom:1.5rem}
.routine-hdr h2{
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(2.5rem,5vw,3.8rem);letter-spacing:0.06em;
  background:linear-gradient(90deg,var(--blue),var(--green));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.routine-meta-row{display:flex;gap:1rem;flex-wrap:wrap;margin-top:0.5rem}

.week-prog-box{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:12px;padding:1.1rem 1.4rem;margin-bottom:1.5rem;
}
.week-prog-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:0.6rem}
.week-prog-top span{font-size:0.75rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-muted)}
.week-prog-top strong{font-family:'Bebas Neue',sans-serif;font-size:1.3rem;letter-spacing:0.08em;color:var(--green)}

.day-card{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:12px;margin-bottom:0.75rem;overflow:hidden;
  transition:border-color 0.25s;
}
.day-card:hover{border-color:rgba(0,194,255,0.2)}
.day-card.day-done{border-color:rgba(0,230,118,0.35)}
.day-hdr{
  display:flex;align-items:center;gap:0.9rem;
  padding:0.9rem 1.1rem;cursor:pointer;
}
.day-num{
  font-family:'Bebas Neue',sans-serif;font-size:1.5rem;
  letter-spacing:0.08em;color:var(--text-muted);
  min-width:1.8rem;text-align:center;
}
.day-card.day-done .day-num{color:var(--green)}
.day-info{flex:1}
.day-name{font-weight:700;font-size:0.95rem;color:var(--text)}
.day-focus{font-size:0.78rem;color:var(--text-muted)}
.day-tick{
  width:26px;height:26px;border-radius:50%;
  border:2px solid var(--border);
  display:flex;align-items:center;justify-content:center;
  font-size:0.78rem;cursor:pointer;transition:all 0.2s;flex-shrink:0;
}
.day-tick:hover{border-color:var(--green)}
.day-tick.ticked{background:var(--green);border-color:var(--green);color:var(--bg)}
.day-chev{font-size:0.7rem;color:var(--text-muted);transition:transform 0.25s;flex-shrink:0}
.day-card.open .day-chev{transform:rotate(180deg)}
.day-body{display:none;padding:0 1.1rem 1.1rem}
.day-card.open .day-body{display:block}

.act-list{list-style:none}
.act-item{
  display:flex;align-items:flex-start;gap:0.75rem;
  padding:0.7rem 0;border-bottom:1px solid rgba(255,255,255,0.04);
}
.act-item:last-child{border-bottom:none}
.act-ico{
  width:34px;height:34px;border-radius:8px;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;font-size:1rem;
}
.act-ico.phys{background:rgba(0,194,255,0.1)}
.act-ico.psyc{background:rgba(124,58,237,0.12)}
.act-ico.spir{background:rgba(0,230,118,0.1)}
.act-content{flex:1}
.act-name{font-weight:600;font-size:0.92rem;color:var(--text)}
.act-desc{font-size:0.79rem;color:var(--text-muted);margin-top:0.2rem;line-height:1.5}
.act-dur{font-size:0.68rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--green);font-weight:600;flex-shrink:0;margin-top:4px}
.act-check-btn{
  display:inline-flex;align-items:center;gap:0.35rem;
  margin-top:0.5rem;padding:0.25rem 0.7rem;
  background:var(--panel);border:1px solid var(--border);
  border-radius:100px;font-size:0.72rem;color:var(--text-muted);
  cursor:pointer;transition:all 0.18s;
}
.act-check-btn:hover{border-color:var(--green-dark);color:var(--text)}
.act-check-btn.ticked{background:rgba(0,230,118,0.12);border-color:var(--green-dark);color:var(--green)}

.routine-quote{
  margin-top:1.5rem;padding:1rem 1.2rem;
  border-left:3px solid var(--blue);
  background:rgba(0,194,255,0.04);border-radius:0 10px 10px 0;
  font-size:0.88rem;color:var(--text-muted);font-style:italic;line-height:1.6;
}
.routine-quote cite{display:block;font-style:normal;font-size:0.7rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--blue-dark);margin-top:0.35rem}

.routine-actions{display:flex;gap:0.75rem;justify-content:center;flex-wrap:wrap;margin-top:2.5rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: REVIEW â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: RESULTS â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.results-hero-sec{text-align:center;margin-bottom:2.5rem}
.big-score{
  font-family:'Bebas Neue',sans-serif;font-size:7rem;
  letter-spacing:0.04em;line-height:1;
  background:linear-gradient(135deg,var(--blue),var(--green));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.results-title{
  font-family:'Syne',sans-serif;font-weight:800;
  font-size:clamp(1.8rem,3.5vw,2.8rem);color:var(--text);margin-top:0.5rem;
}
.compare-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-bottom:2rem}
.compare-card{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:12px;padding:1.2rem 1.4rem;
}
.compare-card h4{font-size:0.72rem;letter-spacing:0.18em;text-transform:uppercase;color:var(--text-muted);margin-bottom:0.5rem}
.delta{font-family:'Bebas Neue',sans-serif;font-size:2.2rem;letter-spacing:0.04em}
.delta-up{color:var(--green)}
.delta-down{color:var(--red)}
.delta-same{color:var(--yellow)}
.compare-detail{font-size:0.8rem;color:var(--text-muted);margin-top:0.2rem}

.ach-section h3{
  font-family:'Syne',sans-serif;font-size:1rem;font-weight:700;
  color:var(--blue);margin-bottom:0.75rem;
}
.ach-item{
  display:flex;gap:0.7rem;padding:0.7rem 0;
  border-bottom:1px solid var(--border);font-size:0.87rem;color:var(--text-muted);line-height:1.5;
}
.ach-item:last-child{border-bottom:none}
.ach-ico{font-size:1.1rem;flex-shrink:0}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â”€â”€â”€â”€ SCREEN: ADMIN â”€â”€â”€â”€
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.admin-header{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:2rem;flex-wrap:gap;gap:1rem;
}
.admin-header h1{font-family:'Syne',sans-serif;font-weight:800;font-size:2rem;color:var(--text)}
.admin-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:2rem}
.admin-stat{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:12px;padding:1.2rem 1.4rem;
}
.admin-stat-num{
  font-family:'Bebas Neue',sans-serif;font-size:2.2rem;letter-spacing:0.04em;color:var(--blue);
}
.admin-stat-lbl{font-size:0.72rem;text-transform:uppercase;letter-spacing:0.12em;color:var(--text-muted);margin-top:0.2rem}
.admin-table{width:100%;border-collapse:collapse;font-size:0.85rem}
.admin-table th{
  text-align:left;padding:0.65rem 1rem;
  background:var(--bg3);border-bottom:1px solid var(--border);
  font-size:0.7rem;letter-spacing:0.15em;text-transform:uppercase;color:var(--text-muted);
}
.admin-table td{
  padding:0.75rem 1rem;border-bottom:1px solid rgba(255,255,255,0.04);
  color:var(--text);
}
.admin-table tr:hover td{background:var(--panel)}
.admin-table-wrap{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:12px;overflow:hidden;overflow-x:auto;
}
.admin-search{
  display:flex;gap:0.75rem;margin-bottom:1rem;flex-wrap:wrap;
}
.admin-search input{
  flex:1;min-width:200px;padding:0.6rem 1rem;
  background:var(--panel);border:1px solid var(--border);
  border-radius:8px;color:var(--text);
  font-family:'DM Sans',sans-serif;font-size:0.87rem;
}
.admin-search input:focus{outline:none;border-color:var(--blue)}
.admin-empty{text-align:center;padding:3rem;color:var(--text-muted);font-size:0.9rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:900px){
  .blog-grid{grid-template-columns:1fr 1fr}
  .blog-card.featured{grid-column:1/-1}
  .data-grid{grid-template-columns:1fr 1fr}
  .stats-strip{grid-template-columns:repeat(2,1fr)}
  .compare-grid{grid-template-columns:1fr}
  .admin-stats{grid-template-columns:repeat(2,1fr)}
}
@media(max-width:600px){
  .blog-grid{grid-template-columns:1fr}
  .data-grid{grid-template-columns:1fr}
  .topbar-nav{display:none}
  .admin-stats{grid-template-columns:1fr 1fr}
}
</style>
</head>
<body>

<!-- â•â•â• TOPBAR â•â•â• -->
<nav class="topbar">
  <div class="topbar-logo" onclick="goHome()">APEX</div>
  <div class="topbar-sep"></div>
  <div class="topbar-nav" id="topbar-nav">
    <button onclick="goHome()">Inicio</button>
    <button id="nav-routine" style="display:none" onclick="showScreen('routine')">Mi Rutina</button>
    <button id="nav-admin" style="display:none" onclick="showScreen('admin');renderAdmin()">Admin</button>
  </div>
  <div class="topbar-auth" id="topbar-auth">
    <button class="btn btn-outline btn-sm" onclick="showScreen('auth')">Iniciar sesiÃ³n</button>
    <button class="btn btn-blue btn-sm" onclick="showAuthTab('register')">Registrarse</button>
  </div>
  <div class="topbar-user" id="topbar-user" style="display:none">
    <div class="topbar-avatar" id="topbar-avatar">?</div>
    <span id="topbar-name"></span>
    <button class="btn btn-ghost btn-sm" onclick="logout()">Salir</button>
  </div>
</nav>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: HOME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen active" id="screen-home">

  <!-- HERO -->
  <div class="home-hero">
    <p class="hero-eyebrow">Plataforma de Rendimiento Integral Â· Bachillerato 11Â°</p>
    <h1 class="hero-h1">
      <span class="line1">APEX</span><br>
      <span class="line2">RENDIMIENTO</span>
    </h1>
    <p class="hero-sub">
      Mejora tu <strong>salud fÃ­sica y mental</strong> con rutinas personalizadas basadas en ciencia del deporte y psicologÃ­a del rendimiento.
    </p>
    <div class="hero-pills">
      <span class="badge badge-blue">ğŸƒ CondiciÃ³n fÃ­sica</span>
      <span class="badge badge-purple">ğŸ§  Salud mental</span>
      <span class="badge badge-green">ğŸ˜´ RecuperaciÃ³n</span>
      <span class="badge badge-blue">ğŸ“Š Seguimiento</span>
    </div>
    <div class="hero-cta">
      <button class="btn btn-blue btn-lg" onclick="startApp()">â–¶ Crear mi rutina personalizada</button>
      <button class="btn btn-ghost btn-lg" onclick="document.getElementById('blog-sec').scrollIntoView({behavior:'smooth'})">Leer mÃ¡s â†“</button>
    </div>
    <div class="hero-disclaimer">
      <strong>âš ï¸ Herramienta complementaria:</strong> APEX no reemplaza la consulta con un especialista en salud deportiva o psicolÃ³gica. Para diagnÃ³sticos o condiciones especÃ­ficas, acude siempre a un profesional certificado.
    </div>
  </div>

  <!-- STATS STRIP -->
  <div class="stats-strip">
    <div class="stat-cell"><div class="stat-num blue">30%</div><div class="stat-lbl">Mejora en concentraciÃ³n con ejercicio regular</div></div>
    <div class="stat-cell"><div class="stat-num green">2x</div><div class="stat-lbl">MÃ¡s resiliencia con hÃ¡bitos de bienestar</div></div>
    <div class="stat-cell"><div class="stat-num purple">68%</div><div class="stat-lbl">ReducciÃ³n de ansiedad con movimiento diario</div></div>
    <div class="stat-cell"><div class="stat-num yellow">7min</div><div class="stat-lbl">De actividad fÃ­sica ya activan endorfinas</div></div>
  </div>

  <!-- BLOG SECTION -->
  <div class="blog-section" id="blog-sec">
    <div class="blog-inner">
      <div class="blog-header">
        <div>
          <span class="section-label">Conocimiento</span>
          <h2 class="section-title">Ciencia del <span class="accent">bienestar</span></h2>
          <div class="divider divider-blue"></div>
        </div>
        <span class="badge badge-blue">Basado en evidencia</span>
      </div>
      <div class="blog-grid">

        <!-- Featured -->
        <div class="blog-card featured" onclick="openBlog('physical')">
          <div class="blog-card-img physical">ğŸ‹ï¸</div>
          <div class="blog-body">
            <div class="blog-cat phy">Salud FÃ­sica</div>
            <div class="blog-title">Por quÃ© el ejercicio es el mejor potenciador del rendimiento acadÃ©mico</div>
            <div class="blog-excerpt">Estudios de la Universidad de Harvard demuestran que 20 minutos de actividad aerÃ³bica diaria aumentan el BDNF (factor neurotrÃ³fico derivado del cerebro), mejorando memoria, atenciÃ³n y velocidad de procesamiento hasta por 3 horas despuÃ©s del ejercicio.</div>
            <div class="blog-meta"><span>Salud deportiva</span><div class="blog-dot"></div><span>5 min lectura</span></div>
          </div>
        </div>

        <!-- Mental -->
        <div class="blog-card" onclick="openBlog('mental')">
          <div class="blog-card-img mental">ğŸ§ </div>
          <div class="blog-body">
            <div class="blog-cat men">Salud Mental</div>
            <div class="blog-title">GestiÃ³n del estrÃ©s acadÃ©mico: quÃ© funciona realmente</div>
            <div class="blog-excerpt">El estrÃ©s crÃ³nico reduce el volumen del hipocampo â€” el centro de la memoria. Las tÃ©cnicas de mindfulness y respiraciÃ³n pueden revertirlo en semanas.</div>
            <div class="blog-meta"><span>PsicologÃ­a</span><div class="blog-dot"></div><span>4 min</span></div>
          </div>
        </div>

        <!-- Sleep -->
        <div class="blog-card" onclick="openBlog('sleep')">
          <div class="blog-card-img sleep">ğŸ˜´</div>
          <div class="blog-body">
            <div class="blog-cat slp">RecuperaciÃ³n</div>
            <div class="blog-title">El sueÃ±o: el entrenamiento invisible que estÃ¡s perdiendo</div>
            <div class="blog-excerpt">Dormir menos de 7 horas reduce la consolidaciÃ³n de memoria en un 40% y eleva el cortisol. La recuperaciÃ³n es tan importante como el esfuerzo.</div>
            <div class="blog-meta"><span>NeurofisiologÃ­a</span><div class="blog-dot"></div><span>3 min</span></div>
          </div>
        </div>

      </div>

      <!-- Second row -->
      <div class="blog-grid" style="margin-top:1.5rem;grid-template-columns:1fr 1fr 1fr">
        <div class="blog-card" onclick="openBlog('nutrition')">
          <div class="blog-card-img nutrition" style="height:120px;font-size:2.5rem">ğŸ¥—</div>
          <div class="blog-body">
            <div class="blog-cat nut">NutriciÃ³n</div>
            <div class="blog-title">AlimentaciÃ³n e inteligencia: cÃ³mo lo que comes afecta tu mente</div>
            <div class="blog-excerpt">El cerebro consume 20% de tu energÃ­a. Los Ã¡cidos grasos omega-3 y la hidrataciÃ³n impactan directamente la funciÃ³n cognitiva.</div>
            <div class="blog-meta"><span>NutriciÃ³n deportiva</span><div class="blog-dot"></div><span>3 min</span></div>
          </div>
        </div>
        <div class="blog-card" onclick="openBlog('habits')">
          <div class="blog-card-img physical" style="height:120px;font-size:2.5rem">ğŸ”„</div>
          <div class="blog-body">
            <div class="blog-cat phy">HÃ¡bitos</div>
            <div class="blog-title">La regla de los 21 dÃ­as y la ciencia real detrÃ¡s de los hÃ¡bitos</div>
            <div class="blog-excerpt">Formar un hÃ¡bito toma entre 18 y 254 dÃ­as segÃºn el MIT. Conoce las estrategias basadas en evidencia para que los tuyos duren.</div>
            <div class="blog-meta"><span>PsicologÃ­a del comportamiento</span><div class="blog-dot"></div><span>4 min</span></div>
          </div>
        </div>
        <div class="blog-card" onclick="openBlog('anxiety')">
          <div class="blog-card-img mental" style="height:120px;font-size:2.5rem">ğŸ’­</div>
          <div class="blog-body">
            <div class="blog-cat men">Ansiedad</div>
            <div class="blog-title">Ansiedad precompetitiva: cÃ³mo convertirla en combustible</div>
            <div class="blog-excerpt">Los atletas de Ã©lite no eliminan los nervios â€” los reencuadran. Aprende a usar la activaciÃ³n fisiolÃ³gica a tu favor con tÃ©cnicas cognitivas.</div>
            <div class="blog-meta"><span>PsicologÃ­a del deporte</span><div class="blog-dot"></div><span>4 min</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DATA SECTION -->
  <div class="data-section">
    <div class="data-inner">
      <span class="section-label">Evidencia cientÃ­fica</span>
      <h2 class="section-title">Datos que <span class="accent-g">importan</span></h2>
      <div class="divider divider-green"></div>
      <div class="data-grid">
        <div class="data-card dc-blue">
          <div class="data-icon">ğŸƒ</div>
          <div class="data-headline blue">23%</div>
          <p class="data-desc">Los estudiantes fÃ­sicamente activos obtienen calificaciones un 23% mÃ¡s altas en promedio que sus pares sedentarios, segÃºn estudios de la OMS.</p>
          <div class="data-source">Fuente: OMS, 2022 â€” Global Action Plan on Physical Activity</div>
        </div>
        <div class="data-card dc-green">
          <div class="data-icon">ğŸ§ </div>
          <div class="data-headline green">89%</div>
          <p class="data-desc">De los estudiantes de bachillerato reportan niveles altos de estrÃ©s. El manejo psicolÃ³gico activo puede reducir sÃ­ntomas en 6 semanas.</p>
          <div class="data-source">Fuente: APA (American Psychological Association), 2023</div>
        </div>
        <div class="data-card dc-purple">
          <div class="data-icon">ğŸ˜´</div>
          <div class="data-headline purple">66%</div>
          <p class="data-desc">De adolescentes duermen menos de las 8â€“10 horas recomendadas. Cada hora faltante reduce la retenciÃ³n de informaciÃ³n hasta un 16%.</p>
          <div class="data-source">Fuente: National Sleep Foundation, 2023</div>
        </div>
        <div class="data-card dc-blue">
          <div class="data-icon">ğŸŒ¬ï¸</div>
          <div class="data-headline blue">4 min</div>
          <p class="data-desc">De respiraciÃ³n diafragmÃ¡tica profunda activa el sistema nervioso parasimpÃ¡tico y reduce el cortisol en sangre de manera medible.</p>
          <div class="data-source">Fuente: Journal of Clinical Psychology, 2021</div>
        </div>
        <div class="data-card dc-green">
          <div class="data-icon">ğŸ¤¸</div>
          <div class="data-headline green">30 min</div>
          <p class="data-desc">De ejercicio aerÃ³bico moderado 3 veces por semana equivale, en efectividad para el estado de Ã¡nimo, a medicaciÃ³n antidepresiva en casos leves-moderados.</p>
          <div class="data-source">Fuente: JAMA Psychiatry, Meta-anÃ¡lisis 2023</div>
        </div>
        <div class="data-card dc-purple">
          <div class="data-icon">ğŸ“±</div>
          <div class="data-headline purple">2.5h</div>
          <p class="data-desc">Es el tiempo promedio diario de redes sociales de un adolescente colombiano. Reducirlo 30 min mejora el bienestar subjetivo significativamente.</p>
          <div class="data-source">Fuente: DataReportal Colombia, 2024</div>
        </div>
      </div>
    </div>
  </div>

  <!-- CTA SECTION -->
  <div class="cta-section">
    <div class="cta-inner">
      <span class="section-label">Empieza hoy</span>
      <h2 class="section-title">Tu semana de <span class="accent">alto rendimiento</span> comienza aquÃ­</h2>
      <p style="color:var(--text-muted);margin:1rem 0 2rem;font-size:1rem">Responde el formulario, recibe tu rutina personalizada y sigue tu progreso durante 7 dÃ­as.</p>
      <button class="btn btn-blue btn-lg" onclick="startApp()">â–¶ Crear mi rutina personalizada</button>
      <p style="font-size:0.75rem;color:var(--text-muted);margin-top:1rem">Gratis Â· Sin datos sensibles Â· Herramienta complementaria</p>
    </div>
  </div>

  <footer class="home-footer">
    <p>APEX Rendimiento Integral Â· Colegio San BartolomÃ© La Merced Â· Bachillerato 11Â° Â· 2025</p>
    <p style="margin-top:0.4rem">âš ï¸ Esta herramienta es de orientaciÃ³n general. Para atenciÃ³n especializada consulta a un profesional de salud deportiva o psicolÃ³gica.</p>
  </footer>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: BLOG ARTICLE (modal-style)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-blog">
  <div class="page-wrap">
    <button class="btn btn-ghost btn-sm" onclick="showScreen('home')" style="margin-bottom:1.5rem">â† Volver</button>
    <div id="blog-content"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: AUTH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-auth">
  <div class="auth-box">
    <div class="auth-logo">APEX</div>
    <div class="auth-subtitle">Rendimiento Integral Â· San BartolomÃ©</div>
    <div class="auth-tabs">
      <button class="auth-tab active" id="tab-login" onclick="showAuthTab('login')">Iniciar sesiÃ³n</button>
      <button class="auth-tab" id="tab-register" onclick="showAuthTab('register')">Registrarse</button>
    </div>
    <div class="auth-error" id="auth-error"></div>

    <!-- LOGIN -->
    <div id="form-login">
      <div class="field">
        <label>Correo electrÃ³nico</label>
        <input type="email" id="login-email" placeholder="tu@correo.com" onkeydown="if(event.key==='Enter')doLogin()">
      </div>
      <div class="field">
        <label>ContraseÃ±a</label>
        <input type="password" id="login-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" onkeydown="if(event.key==='Enter')doLogin()">
      </div>
      <button class="btn btn-blue btn-full" onclick="doLogin()">Iniciar sesiÃ³n</button>
    </div>

    <!-- REGISTER -->
    <div id="form-register" style="display:none">
      <div class="field">
        <label>Nombre completo <span>*</span></label>
        <input type="text" id="reg-name" placeholder="Tu nombre">
      </div>
      <div class="field">
        <label>Correo electrÃ³nico <span>*</span></label>
        <input type="email" id="reg-email" placeholder="tu@correo.com">
      </div>
      <div class="field">
        <label>ContraseÃ±a <span>*</span></label>
        <input type="password" id="reg-pass" placeholder="MÃ­nimo 6 caracteres">
      </div>
      <div class="field">
        <label>CÃ³digo de acceso (si tienes uno)</label>
        <input type="text" id="reg-code" placeholder="Ej: SBADMIN2025">
      </div>
      <button class="btn btn-green btn-full" onclick="doRegister()">Crear cuenta</button>
    </div>

    <div class="auth-sep">â€”</div>
    <div class="auth-back"><a onclick="showScreen('home')">â† Volver al inicio</a></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: FORM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-form">
  <div class="page-wrap">
    <div style="margin-bottom:2rem">
      <span class="section-label">EvaluaciÃ³n inicial</span>
      <h2 class="section-title">Tu perfil de <span class="accent">rendimiento</span></h2>
      <div class="divider divider-blue"></div>
      <p style="color:var(--text-muted);font-size:0.9rem">Responde con honestidad. Tus respuestas generan una rutina 100% personalizada para ti.</p>
    </div>

    <!-- FÃSICA -->
    <div class="form-section-hdr">ğŸƒ Estado FÃ­sico Actual</div>

    <div class="field">
      <label>Nivel de energÃ­a hoy <span>*</span></label>
      <div class="scale-row" id="s-energia"></div>
      <div class="scale-labels"><span>Sin energÃ­a</span><span>Lleno de energÃ­a</span></div>
    </div>
    <div class="field">
      <label>DÃ­as de actividad fÃ­sica a la semana <span>*</span></label>
      <select id="sel-dias">
        <option value="">Selecciona...</option>
        <option value="0">Ninguno</option>
        <option value="1">1 dÃ­a</option>
        <option value="2">2 dÃ­as</option>
        <option value="3">3 dÃ­as</option>
        <option value="4">4 o mÃ¡s</option>
      </select>
    </div>
    <div class="field">
      <label>Situaciones fÃ­sicas actuales (selecciona las que apliquen)</label>
      <div class="check-group" id="chk-fis">
        <div class="check-item" data-v="ninguna"><div class="chk"></div><span>Sin limitaciones</span></div>
        <div class="check-item" data-v="espalda"><div class="chk"></div><span>Dolor de espalda o mala postura</span></div>
        <div class="check-item" data-v="cansancio"><div class="chk"></div><span>Fatiga o cansancio frecuente</span></div>
        <div class="check-item" data-v="sedentario"><div class="chk"></div><span>Mucho tiempo sentado, poco movimiento</span></div>
        <div class="check-item" data-v="tension"><div class="chk"></div><span>TensiÃ³n muscular (cuello, hombros)</span></div>
        <div class="check-item" data-v="sueno_malo"><div class="chk"></div><span>Dificultad para dormir</span></div>
      </div>
    </div>
    <div class="field">
      <label>Calidad del sueÃ±o esta semana <span>*</span></label>
      <div class="scale-row" id="s-sueno"></div>
      <div class="scale-labels"><span>Muy mala</span><span>Excelente</span></div>
    </div>

    <!-- PSICOLÃ“GICA -->
    <div class="form-section-hdr">ğŸ§  Estado PsicolÃ³gico</div>

    <div class="field">
      <label>Nivel de estrÃ©s esta semana <span>*</span></label>
      <div class="scale-row" id="s-estres"></div>
      <div class="scale-labels"><span>Sin estrÃ©s</span><span>EstrÃ©s muy alto</span></div>
    </div>
    <div class="field">
      <label>Estado de Ã¡nimo general <span>*</span></label>
      <div class="scale-row" id="s-animo"></div>
      <div class="scale-labels"><span>Muy bajo</span><span>Muy positivo</span></div>
    </div>
    <div class="field">
      <label>Aspectos psicolÃ³gicos a trabajar</label>
      <div class="check-group" id="chk-psi">
        <div class="check-item" data-v="ok"><div class="chk"></div><span>Me siento bien en general</span></div>
        <div class="check-item" data-v="concentracion"><div class="chk"></div><span>ConcentraciÃ³n y foco</span></div>
        <div class="check-item" data-v="ansiedad"><div class="chk"></div><span>Ansiedad (exÃ¡menes, futuro)</span></div>
        <div class="check-item" data-v="motivacion"><div class="chk"></div><span>MotivaciÃ³n y propÃ³sito</span></div>
        <div class="check-item" data-v="autoestima"><div class="chk"></div><span>Autoestima y confianza</span></div>
        <div class="check-item" data-v="tiempo"><div class="chk"></div><span>GestiÃ³n del tiempo</span></div>
        <div class="check-item" data-v="relaciones"><div class="chk"></div><span>Relaciones interpersonales</span></div>
      </div>
    </div>
    <div class="field">
      <label>Tiempo libre real al dÃ­a</label>
      <select id="sel-tiempo">
        <option value="">Selecciona...</option>
        <option value="poco">Menos de 30 min</option>
        <option value="medio">30â€“60 min</option>
        <option value="bastante">1â€“2 horas</option>
        <option value="mucho">MÃ¡s de 2 horas</option>
      </select>
    </div>
    <div class="field">
      <label>Â¿QuÃ© quieres mejorar esta semana? (opcional)</label>
      <textarea id="txt-meta" placeholder="Ej: quiero dormir mejor, manejar el estrÃ©s de los parciales, sentirme con mÃ¡s energÃ­a..."></textarea>
    </div>

    <div style="display:flex;gap:0.75rem;justify-content:flex-end;margin-top:1.5rem;flex-wrap:wrap">
      <button class="btn btn-ghost" onclick="goHome()">â† Volver</button>
      <button class="btn btn-blue btn-lg" onclick="submitForm()">Generar rutina â–¶</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: LOADING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-loading">
  <div class="loader-ring"></div>
  <div class="loader-title" id="load-title">Analizando tu perfil...</div>
  <p class="loader-sub" id="load-sub">Creando tu semana de alto rendimiento</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: ROUTINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-routine">
  <div class="page-wrap">
    <div class="routine-hdr">
      <h2 id="rout-title">SEMANA APEX</h2>
      <div class="routine-meta-row">
        <span class="badge badge-blue" id="rout-meta">Rutina personalizada</span>
        <span class="badge badge-green">7 dÃ­as Â· Bajo riesgo</span>
      </div>
    </div>
    <div class="week-prog-box">
      <div class="week-prog-top">
        <span>Progreso semanal</span>
        <strong id="prog-pct">0%</strong>
      </div>
      <div class="prog-track"><div class="prog-fill prog-green" id="prog-bar" style="width:0%"></div></div>
    </div>
    <div id="days-container"></div>
    <div class="routine-quote" id="rout-quote"></div>
    <div class="routine-actions">
      <button class="btn btn-ghost" onclick="resetRoutine()">â†º Nueva semana</button>
      <button class="btn btn-purple" onclick="goToReview()">Finalizar semana â†’ Ver progreso</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: REVIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-review">
  <div class="page-wrap">
    <div style="margin-bottom:2rem">
      <span class="section-label">EvaluaciÃ³n final</span>
      <h2 class="section-title">Â¿CÃ³mo te sientes <span class="accent-g">ahora</span>?</h2>
      <div class="divider divider-green"></div>
      <p style="color:var(--text-muted);font-size:0.9rem">Completaste una semana APEX. EvalÃºa tu estado para ver tu progreso real.</p>
    </div>

    <div class="form-section-hdr">ğŸƒ Estado FÃ­sico Ahora</div>
    <div class="field">
      <label>Nivel de energÃ­a ahora</label>
      <div class="scale-row" id="r-s-energia"></div>
      <div class="scale-labels"><span>Sin energÃ­a</span><span>Lleno de energÃ­a</span></div>
    </div>
    <div class="field">
      <label>Calidad del sueÃ±o esta semana</label>
      <div class="scale-row" id="r-s-sueno"></div>
      <div class="scale-labels"><span>Muy mala</span><span>Excelente</span></div>
    </div>

    <div class="form-section-hdr">ğŸ§  Estado PsicolÃ³gico Ahora</div>
    <div class="field">
      <label>Nivel de estrÃ©s esta semana</label>
      <div class="scale-row" id="r-s-estres"></div>
      <div class="scale-labels"><span>Sin estrÃ©s</span><span>EstrÃ©s muy alto</span></div>
    </div>
    <div class="field">
      <label>Estado de Ã¡nimo ahora</label>
      <div class="scale-row" id="r-s-animo"></div>
      <div class="scale-labels"><span>Muy bajo</span><span>Muy positivo</span></div>
    </div>

    <div class="form-section-hdr">ğŸ“ ReflexiÃ³n</div>
    <div class="field">
      <label>Â¿CuÃ¡l fue tu mayor aprendizaje o cambio esta semana?</label>
      <textarea id="r-reflexion" placeholder="Escribe libremente..."></textarea>
    </div>
    <div class="field">
      <label>Â¿QuÃ© actividades completaste mejor?</label>
      <textarea id="r-logros" placeholder="Ej: los ejercicios de respiraciÃ³n, las caminatas..."></textarea>
    </div>

    <div style="display:flex;gap:0.75rem;justify-content:flex-end;margin-top:1.5rem;flex-wrap:wrap">
      <button class="btn btn-ghost" onclick="showScreen('routine')">â† Volver</button>
      <button class="btn btn-green btn-lg" onclick="submitReview()">Ver mi progreso â–¶</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: RESULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-results">
  <div class="page-wrap">
    <div class="results-hero-sec">
      <div class="big-score" id="res-score">--/--</div>
      <div style="font-size:0.72rem;letter-spacing:0.25em;text-transform:uppercase;color:var(--text-muted)">Actividades completadas</div>
      <div class="results-title" id="res-title">Tu semana APEX</div>
    </div>
    <div class="compare-grid" id="compare-grid"></div>
    <div class="ach-section">
      <h3>â–¶ Tus logros y observaciones</h3>
      <div id="ach-list"></div>
    </div>
    <div class="routine-quote" id="res-quote" style="margin-top:1.5rem"></div>
    <div style="margin:2rem 0;padding:1rem 1.2rem;background:rgba(255,71,87,0.06);border:1px solid rgba(255,71,87,0.2);border-radius:10px;font-size:0.8rem;color:rgba(232,240,254,0.55);line-height:1.6">
      <strong style="color:var(--red)">Recuerda:</strong> APEX es una herramienta de orientaciÃ³n complementaria. Si notaste dificultades persistentes o quieres profundizar en tu desarrollo, <strong style="color:var(--text)">consulta a un especialista en salud deportiva o psicolÃ³gica.</strong>
    </div>
    <div style="display:flex;gap:0.75rem;justify-content:center;flex-wrap:wrap">
      <button class="btn btn-ghost" onclick="resetRoutine()">â†º Nueva semana</button>
      <button class="btn btn-blue" onclick="showScreen('routine')">â† Ver mi rutina</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN: ADMIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-admin">
  <div class="page-wrap-wide">
    <div class="admin-header">
      <h1>Panel Administrador</h1>
      <span class="badge badge-purple">ğŸ”’ Acceso restringido</span>
    </div>
    <div class="admin-stats" id="admin-stats-grid">
      <div class="admin-stat"><div class="admin-stat-num" id="stat-users">0</div><div class="admin-stat-lbl">Usuarios registrados</div></div>
      <div class="admin-stat"><div class="admin-stat-num" id="stat-active" style="color:var(--green)">0</div><div class="admin-stat-lbl">Con rutina activa</div></div>
      <div class="admin-stat"><div class="admin-stat-num" id="stat-completed" style="color:var(--purple-light)">0</div><div class="admin-stat-lbl">Semanas completadas</div></div>
      <div class="admin-stat"><div class="admin-stat-num" id="stat-avg-prog" style="color:var(--yellow)">0%</div><div class="admin-stat-lbl">Progreso promedio</div></div>
    </div>
    <div class="admin-search">
      <input type="text" id="admin-search-input" placeholder="ğŸ” Buscar por nombre o correo..." oninput="filterAdminTable()">
      <button class="btn btn-ghost btn-sm" onclick="renderAdmin()">â†º Actualizar</button>
    </div>
    <div class="admin-table-wrap">
      <table class="admin-table" id="admin-table">
        <thead>
          <tr>
            <th>Usuario</th>
            <th>Correo</th>
            <th>Registro</th>
            <th>Rutina</th>
            <th>Progreso</th>
            <th>Ãšltima actividad</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody id="admin-tbody"></tbody>
      </table>
      <div class="admin-empty" id="admin-empty" style="display:none">No hay usuarios registrados aÃºn.</div>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONSTANTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ADMIN_CODE = 'SBADMIN2025';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SESSION STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let session = { user: null }; // { uid, name, email, isAdmin }
let appState = { form: {}, routine: null, progress: {}, review: {} };

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STORAGE HELPERS â€” localStorage (works anywhere)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// "shared" keys are prefixed with "apex_shared_" so all users on the
// same browser domain share them (users index, user profiles).
// Personal keys are prefixed with "apex_" only.
function stKey(key, shared) { return (shared ? 'apex_shared_' : 'apex_') + key; }

async function stGet(key, shared=false) {
  try {
    const raw = localStorage.getItem(stKey(key, shared));
    return raw ? JSON.parse(raw) : null;
  } catch(e) { return null; }
}
async function stSet(key, val, shared=false) {
  try { localStorage.setItem(stKey(key, shared), JSON.stringify(val)); } catch(e){}
}
async function stDel(key, shared=false) {
  try { localStorage.removeItem(stKey(key, shared)); } catch(e){}
}
async function stList(prefix='', shared=false) {
  try {
    const fullPrefix = stKey(prefix, shared);
    return Object.keys(localStorage)
      .filter(k => k.startsWith(fullPrefix))
      .map(k => k.slice(stKey('', shared).length));
  } catch(e) { return []; }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-'+id).classList.add('active');
  window.scrollTo(0,0);
}
function goHome(){ showScreen('home'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UI HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let toastT;
function toast(msg, type='success') {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className = `toast toast-${type} show`;
  clearTimeout(toastT);
  toastT = setTimeout(()=>el.classList.remove('show'), 2800);
}

function buildScale(id) {
  const el = document.getElementById(id); if(!el) return;
  el.innerHTML='';
  for(let i=1;i<=5;i++){
    const b=document.createElement('button');
    b.className='scale-btn';b.textContent=i;b.dataset.v=i;
    b.onclick=()=>{el.querySelectorAll('.scale-btn').forEach(x=>x.classList.remove('sel'));b.classList.add('sel')};
    el.appendChild(b);
  }
}
function getScale(id){ const s=document.querySelector(`#${id} .scale-btn.sel`); return s?+s.dataset.v:null; }

function buildChecks(id){
  document.querySelectorAll(`#${id} .check-item`).forEach(item=>{
    item.onclick=()=>{
      item.classList.toggle('sel');
      item.querySelector('.chk').textContent=item.classList.contains('sel')?'âœ“':'';
    };
  });
}
function getChecks(id){ return Array.from(document.querySelectorAll(`#${id} .check-item.sel`)).map(i=>i.dataset.v); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showAuthTab(tab) {
  document.getElementById('form-login').style.display = tab==='login'?'':'none';
  document.getElementById('form-register').style.display = tab==='register'?'':'none';
  document.getElementById('tab-login').className = 'auth-tab'+(tab==='login'?' active':'');
  document.getElementById('tab-register').className = 'auth-tab'+(tab==='register'?' active':'');
  document.getElementById('auth-error').style.display='none';
  showScreen('auth');
}

async function doLogin() {
  const email = document.getElementById('login-email').value.trim().toLowerCase();
  const pass = document.getElementById('login-pass').value;
  const errEl = document.getElementById('auth-error');

  if(!email||!pass){ errEl.textContent='Completa todos los campos.';errEl.style.display='';return; }

  const users = await stGet('users-index', true) || {};
  const uid = users[email];
  if(!uid){ errEl.textContent='No existe una cuenta con ese correo.';errEl.style.display='';return; }

  const userData = await stGet('user-'+uid, true);
  if(!userData||userData.passHash!==simpleHash(pass)){ errEl.textContent='ContraseÃ±a incorrecta.';errEl.style.display='';return; }

  session.user = { uid, name: userData.name, email: userData.email, isAdmin: userData.isAdmin||false };
  await stSet('apex-session', { uid }); // persist session
  await loadUserState();
  updateTopbar();
  toast(`Â¡Bienvenido/a, ${userData.name.split(' ')[0]}! ğŸ‘‹`);

  if(appState.routine){ renderRoutine(); showScreen('routine'); }
  else showScreen('home');
}

async function doRegister() {
  const name = document.getElementById('reg-name').value.trim();
  const email = document.getElementById('reg-email').value.trim().toLowerCase();
  const pass = document.getElementById('reg-pass').value;
  const code = document.getElementById('reg-code').value.trim();
  const errEl = document.getElementById('auth-error');

  if(!name||!email||!pass){ errEl.textContent='Completa nombre, correo y contraseÃ±a.';errEl.style.display='';return; }
  if(pass.length<6){ errEl.textContent='La contraseÃ±a debe tener al menos 6 caracteres.';errEl.style.display='';return; }

  const users = await stGet('users-index', true) || {};
  if(users[email]){ errEl.textContent='Ya existe una cuenta con ese correo.';errEl.style.display='';return; }

  const uid = 'u-' + Date.now() + '-' + Math.random().toString(36).slice(2,6);
  const isAdmin = code === ADMIN_CODE;

  users[email] = uid;
  await stSet('users-index', users, true);
  await stSet('user-'+uid, {
    uid, name, email, isAdmin,
    passHash: simpleHash(pass),
    createdAt: new Date().toISOString()
  }, true);

  session.user = { uid, name, email, isAdmin };
  appState = { form:{}, routine:null, progress:{}, review:{} };
  updateTopbar();
  toast(isAdmin ? 'Â¡Cuenta de administrador creada! ğŸ”’' : 'Â¡Cuenta creada! Bienvenido/a ğŸ‰');
  showScreen('home');
}

function simpleHash(str) {
  let h=5381;
  for(let i=0;i<str.length;i++) h=((h<<5)+h)+str.charCodeAt(i);
  return (h>>>0).toString(36);
}

async function logout() {
  await stDel('apex-session'); // clear persisted session
  session.user = null;
  appState = { form:{}, routine:null, progress:{}, review:{} };
  updateTopbar();
  showScreen('home');
  toast('SesiÃ³n cerrada','info');
}

function updateTopbar() {
  const u = session.user;
  const authEl = document.getElementById('topbar-auth');
  const userEl = document.getElementById('topbar-user');
  const navRoutine = document.getElementById('nav-routine');
  const navAdmin = document.getElementById('nav-admin');

  if(u) {
    authEl.style.display='none';
    userEl.style.display='flex';
    document.getElementById('topbar-avatar').textContent = u.name[0].toUpperCase();
    document.getElementById('topbar-name').textContent = u.name.split(' ')[0];
    navRoutine.style.display = appState.routine ? '' : 'none';
    navAdmin.style.display = u.isAdmin ? '' : 'none';
  } else {
    authEl.style.display='flex';
    userEl.style.display='none';
    navRoutine.style.display='none';
    navAdmin.style.display='none';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// USER STATE PERSISTENCE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadUserState() {
  if(!session.user) return;
  const saved = await stGet('state-'+session.user.uid, true);
  if(saved) appState = saved;
}

async function saveUserState() {
  if(!session.user) return;
  await stSet('state-'+session.user.uid, appState, true);
  // Update user's last activity and progress snapshot
  const userData = await stGet('user-'+session.user.uid, true);
  if(userData) {
    userData.lastActive = new Date().toISOString();
    userData.hasRoutine = !!appState.routine;
    userData.routineTitle = appState.routine?.titulo || '';
    // calc progress pct
    let total=0,done=0;
    if(appState.routine) {
      appState.routine.dias.forEach((d,di)=>{
        const p=appState.progress[di]||{};
        d.actividades.forEach((_,ai)=>{total++;if(p[ai])done++;});
      });
    }
    userData.progressPct = total ? Math.round((done/total)*100) : 0;
    userData.weeksDone = (userData.weeksDone||0) + (appState.review?.submitted ? 1 : 0);
    await stSet('user-'+session.user.uid, userData, true);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// START APP (form or login gate)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startApp() {
  if(!session.user) { showAuthTab('login'); return; }
  initFormUI();
  showScreen('form');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FORM UI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initFormUI() {
  buildScale('s-energia');buildScale('s-sueno');
  buildScale('s-estres');buildScale('s-animo');
  buildChecks('chk-fis');buildChecks('chk-psi');
}

async function submitForm() {
  const e=getScale('s-energia'),su=getScale('s-sueno'),
        es=getScale('s-estres'),an=getScale('s-animo'),
        dias=document.getElementById('sel-dias').value;
  if(!e||!su||!es||!an||!dias){ toast('Completa todos los campos obligatorios','error');return; }

  appState.form = {
    energia:e, sueno:su, estres:es, animo:an,
    dias, condFis:getChecks('chk-fis'),
    aspectPsi:getChecks('chk-psi'),
    tiempo:document.getElementById('sel-tiempo').value,
    meta:document.getElementById('txt-meta').value
  };
  appState.progress = {};
  appState.review = {};
  showScreen('loading');
  await generateRoutine();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CLAUDE API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function generateRoutine() {
  const f = appState.form;
  const msgs = ['Analizando tu perfilâ€¦','DiseÃ±ando actividadesâ€¦','Ajustando intensidadesâ€¦','Optimizando tu semanaâ€¦','Â¡Casi listo!'];
  let mi=0;
  const tick = setInterval(()=>{ if(mi<msgs.length-1)mi++; document.getElementById('load-title').textContent=msgs[mi]; },1100);

  const prompt=`Eres un experto en ciencia del deporte y psicologÃ­a del rendimiento para adolescentes de bachillerato (grado 11).

Perfil del estudiante:
- EnergÃ­a: ${f.energia}/5
- SueÃ±o: ${f.sueno}/5
- EstrÃ©s: ${f.estres}/5 (5=muy alto)
- Ãnimo: ${f.animo}/5
- DÃ­as de ejercicio semanal: ${f.dias}
- Condiciones fÃ­sicas: ${f.condFis?.join(', ')||'ninguna'}
- Aspectos psicolÃ³gicos a trabajar: ${f.aspectPsi?.join(', ')||'ninguno'}
- Tiempo libre diario: ${f.tiempo||'medio'}
- Meta personal: ${f.meta||'mejorar rendimiento general'}

Genera una rutina semanal de 7 dÃ­as personalizada basada ESTRICTAMENTE en ciencia del deporte y psicologÃ­a del rendimiento (sin referencias religiosas o espirituales).

REGLAS:
1. Actividades de BAJO RIESGO sin equipamiento especial ni contacto fÃ­sico intenso
2. NO especializadas en ningÃºn deporte ni condiciÃ³n clÃ­nica
3. Basadas en evidencia cientÃ­fica (neurofisiologÃ­a, psicologÃ­a cognitiva, kinesiologÃ­a)
4. Incluye mezcla de: ejercicio fÃ­sico suave/moderado, tÃ©cnicas psicolÃ³gicas (mindfulness, cognitivo-conductual), higiene del sueÃ±o, nutriciÃ³n bÃ¡sica, gestiÃ³n del estrÃ©s
5. Adaptadas al tiempo libre disponible
6. TÃ­tulo motivador de 3-4 palabras en mayÃºsculas relacionado con rendimiento

Responde SOLO en JSON vÃ¡lido sin markdown:
{
  "titulo": "SEMANA DE ALTO RENDIMIENTO",
  "meta_semana": "objetivo de la semana en 1 frase",
  "cita": {"texto": "dato o frase cientÃ­fica motivadora", "fuente": "InstituciÃ³n o autor cientÃ­fico"},
  "dias": [
    {
      "nombre": "Lunes",
      "enfoque": "Nombre del enfoque del dÃ­a",
      "actividades": [
        {
          "tipo": "fisica" o "psicologica" o "recuperacion",
          "nombre": "Nombre",
          "descripcion": "InstrucciÃ³n clara y prÃ¡ctica (2-3 oraciones)",
          "duracion": "X minutos",
          "icono": "emoji"
        }
      ]
    }
  ]
}
7 dÃ­as exactos. 3-5 actividades por dÃ­a. Tiempo total diario ajustado al tiempo libre disponible.`;

  try {
    const res = await fetch('https://api.anthropic.com/v1/messages',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:4000,messages:[{role:'user',content:prompt}]})
    });
    clearInterval(tick);
    const data = await res.json();
    const text = data.content.map(c=>c.text||'').join('');
    appState.routine = JSON.parse(text.replace(/```json|```/g,'').trim());
  } catch(e) {
    clearInterval(tick);
    appState.routine = getFallback();
  }

  await saveUserState();
  renderRoutine();
  updateTopbar();
  showScreen('routine');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER ROUTINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderRoutine() {
  const r = appState.routine;
  document.getElementById('rout-title').textContent = r.titulo;
  document.getElementById('rout-meta').textContent = r.meta_semana;
  document.getElementById('rout-quote').innerHTML = `"${r.cita.texto}"<cite>${r.cita.fuente}</cite>`;

  const container = document.getElementById('days-container');
  container.innerHTML='';

  r.dias.forEach((day,di)=>{
    const prog = appState.progress[di]||{};
    const allDone = day.actividades.every((_,ai)=>prog[ai]);
    const card=document.createElement('div');
    card.className=`day-card${allDone?' day-done':''}`;
    card.id=`dc-${di}`;
    card.innerHTML=`
      <div class="day-hdr" onclick="toggleDay(${di})">
        <div class="day-num">${di+1}</div>
        <div class="day-info">
          <div class="day-name">${day.nombre}</div>
          <div class="day-focus">${day.enfoque}</div>
        </div>
        <div class="day-tick${allDone?' ticked':''}" id="dt-${di}" onclick="event.stopPropagation();markDay(${di})">${allDone?'âœ“':''}</div>
        <div class="day-chev">â–¼</div>
      </div>
      <div class="day-body">
        <ul class="act-list" id="al-${di}"></ul>
      </div>`;
    container.appendChild(card);

    const list=document.getElementById(`al-${di}`);
    day.actividades.forEach((act,ai)=>{
      const done=prog[ai]||false;
      const li=document.createElement('li');li.className='act-item';
      const icoClass=act.tipo==='psicologica'?'psyc':act.tipo==='recuperacion'?'spir':'phys';
      li.innerHTML=`
        <div class="act-ico ${icoClass}">${act.icono}</div>
        <div class="act-content">
          <div class="act-name">${act.nombre}</div>
          <div class="act-desc">${act.descripcion}</div>
          <div class="act-check-btn${done?' ticked':''}" id="ac-${di}-${ai}" onclick="toggleAct(${di},${ai})">
            ${done?'âœ“ Completado':'â—‹ Marcar como hecho'}
          </div>
        </div>
        <div class="act-dur">${act.duracion}</div>`;
      list.appendChild(li);
    });
  });
  updateProgress();
}

function toggleDay(di){
  document.getElementById(`dc-${di}`).classList.toggle('open');
}

async function toggleAct(di,ai){
  if(!appState.progress[di]) appState.progress[di]={};
  appState.progress[di][ai]=!appState.progress[di][ai];
  const done=appState.progress[di][ai];
  const btn=document.getElementById(`ac-${di}-${ai}`);
  btn.className=`act-check-btn${done?' ticked':''}`;
  btn.textContent=done?'âœ“ Completado':'â—‹ Marcar como hecho';
  updateDayStatus(di);
  updateProgress();
  await saveUserState();
  if(done) toast('Â¡Actividad completada! ğŸ’ª');
}

async function markDay(di){
  const day=appState.routine.dias[di];
  const prog=appState.progress[di]||{};
  const allDone=day.actividades.every((_,ai)=>prog[ai]);
  if(!appState.progress[di]) appState.progress[di]={};
  day.actividades.forEach((_,ai)=>{ appState.progress[di][ai]=!allDone; });
  renderRoutine();
  await saveUserState();
  toast(allDone?'DÃ­a desmarcado':'Â¡DÃ­a completo! ğŸ”¥');
}

function updateDayStatus(di){
  const day=appState.routine.dias[di];
  const prog=appState.progress[di]||{};
  const done=day.actividades.every((_,ai)=>prog[ai]);
  const card=document.getElementById(`dc-${di}`);
  const tick=document.getElementById(`dt-${di}`);
  if(card){ done?card.classList.add('day-done'):card.classList.remove('day-done'); }
  if(tick){ tick.className=`day-tick${done?' ticked':''}`;tick.textContent=done?'âœ“':''; }
}

function updateProgress(){
  if(!appState.routine) return;
  let tot=0,dn=0;
  appState.routine.dias.forEach((d,di)=>{ const p=appState.progress[di]||{}; d.actividades.forEach((_,ai)=>{tot++;if(p[ai])dn++;}); });
  const pct=tot?Math.round((dn/tot)*100):0;
  document.getElementById('prog-pct').textContent=pct+'%';
  document.getElementById('prog-bar').style.width=pct+'%';
}

async function resetRoutine(){
  appState.routine=null;appState.progress={};appState.review={};
  await saveUserState();
  initFormUI();
  showScreen('form');
  updateTopbar();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REVIEW & RESULTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goToReview(){
  ['r-s-energia','r-s-sueno','r-s-estres','r-s-animo'].forEach(buildScale);
  showScreen('review');
}

async function submitReview(){
  const e=getScale('r-s-energia'),su=getScale('r-s-sueno'),
        es=getScale('r-s-estres'),an=getScale('r-s-animo');
  if(!e||!su||!es||!an){ toast('Completa todas las escalas','error');return; }
  appState.review={energia:e,sueno:su,estres:es,animo:an,
    reflexion:document.getElementById('r-reflexion').value,
    logros:document.getElementById('r-logros').value,
    submitted:true};
  await saveUserState();
  renderResults();
  showScreen('results');
}

function renderResults(){
  const f=appState.form,rv=appState.review,r=appState.routine;
  let tot=0,dn=0;
  if(r) r.dias.forEach((d,di)=>{ const p=appState.progress[di]||{}; d.actividades.forEach((_,ai)=>{tot++;if(p[ai])dn++;}); });
  const pct=tot?Math.round((dn/tot)*100):0;
  document.getElementById('res-score').textContent=`${dn}/${tot}`;
  document.getElementById('res-title').textContent=
    pct>=90?'SEMANA DE ALTO RENDIMIENTO ALCANZADA':
    pct>=70?'GRAN AVANCE EN TU RENDIMIENTO':
    pct>=50?'UN PASO FIRME EN LA DIRECCIÃ“N CORRECTA':
    'CADA INICIO ES EL PRIMER PASO';

  const deltas=[
    {l:'EnergÃ­a',b:f.energia,a:rv.energia},
    {l:'SueÃ±o',b:f.sueno,a:rv.sueno},
    {l:'EstrÃ©s',b:f.estres,a:rv.estres,inv:true},
    {l:'Estado de Ãnimo',b:f.animo,a:rv.animo}
  ];
  const grid=document.getElementById('compare-grid');grid.innerHTML='';
  deltas.forEach(d=>{
    let diff=d.a-d.b; if(d.inv)diff=-diff;
    const raw=d.a-d.b;
    const cls=diff>0?'delta-up':diff<0?'delta-down':'delta-same';
    const arr=diff>0?'â†‘':diff<0?'â†“':'â†’';
    grid.innerHTML+=`<div class="compare-card"><h4>${d.l}</h4><div class="delta ${cls}">${arr} ${Math.abs(raw)} pts</div><div class="compare-detail">Antes: ${d.b}/5 â†’ Ahora: ${d.a}/5</div></div>`;
  });

  const ach=document.getElementById('ach-list');ach.innerHTML='';
  const items=[];
  if(pct>=80) items.push({i:'ğŸ†',t:`Completaste el ${pct}% de tu rutina. Â¡Disciplina de alto rendimiento!`});
  else if(pct>=50) items.push({i:'ğŸ’ª',t:`${pct}% completado. Cada actividad suma a tu rendimiento.`});
  else items.push({i:'ğŸŒ±',t:`${pct}% completado. Este es tu punto de partida â€” sigue adelante.`});
  const eImp=rv.energia-f.energia;
  if(eImp>0) items.push({i:'âš¡',t:`Tu energÃ­a mejorÃ³ ${eImp} puntos. El movimiento y el descanso estÃ¡n funcionando.`});
  const sImp=f.estres-rv.estres;
  if(sImp>0) items.push({i:'ğŸ§˜',t:`Tu estrÃ©s bajÃ³ ${sImp} puntos. Las tÃ©cnicas de manejo del estrÃ©s tienen impacto real.`});
  if(sImp<0) items.push({i:'âš ï¸',t:`Tu estrÃ©s subiÃ³. Es comÃºn en temporadas de exÃ¡menes. Considera apoyo profesional.`});
  if(rv.reflexion) items.push({i:'ğŸ“',t:`Tu reflexiÃ³n: "${rv.reflexion.substring(0,100)}${rv.reflexion.length>100?'â€¦':''}"`});
  if(rv.logros) items.push({i:'ğŸ¯',t:`Puntos fuertes: ${rv.logros.substring(0,100)}`});
  items.push({i:'ğŸ”',t:`Inicia una nueva semana y ajusta las actividades que mÃ¡s te costaron. El progreso es progresivo.`});
  items.forEach(item=>{ ach.innerHTML+=`<div class="ach-item"><div class="ach-ico">${item.i}</div><div>${item.t}</div></div>`; });

  const quotes=[
    {t:'El cuerpo logra lo que la mente cree posible.',f:'Kenneth Cooper â€” Padre de la aerÃ³bica'},
    {t:'El rendimiento Ã³ptimo no es un evento, es un proceso diario.',f:'James Clear â€” Atomic Habits'},
    {t:'La salud mental es la base de todo rendimiento sostenido.',f:'APA â€” American Psychological Association'}
  ];
  const q=quotes[Math.floor(Math.random()*quotes.length)];
  document.getElementById('res-quote').innerHTML=`"${q.t}"<cite>${q.f}</cite>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN PANEL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let adminUsers = [];

async function renderAdmin(){
  if(!session.user?.isAdmin){ toast('Acceso denegado','error');return; }
  showScreen('admin');

  const idx = await stGet('users-index', true)||{};
  const emails = Object.keys(idx);
  adminUsers = [];

  for(const email of emails){
    const uid=idx[email];
    const u=await stGet('user-'+uid, true);
    if(u) adminUsers.push(u);
  }

  // Stats
  const withRoutine = adminUsers.filter(u=>u.hasRoutine).length;
  const withWeeks = adminUsers.filter(u=>(u.weeksDone||0)>0).length;
  const avgProg = adminUsers.length ? Math.round(adminUsers.reduce((a,u)=>a+(u.progressPct||0),0)/adminUsers.length) : 0;

  document.getElementById('stat-users').textContent=adminUsers.length;
  document.getElementById('stat-active').textContent=withRoutine;
  document.getElementById('stat-completed').textContent=withWeeks;
  document.getElementById('stat-avg-prog').textContent=avgProg+'%';

  renderAdminTable(adminUsers);
}

function renderAdminTable(users){
  const tbody=document.getElementById('admin-tbody');
  const empty=document.getElementById('admin-empty');
  tbody.innerHTML='';
  if(!users.length){ empty.style.display='';return; }
  empty.style.display='none';
  users.forEach(u=>{
    const pct=u.progressPct||0;
    const progColor=pct>=80?'var(--green)':pct>=50?'var(--yellow)':'var(--red)';
    const lastActive=u.lastActive?new Date(u.lastActive).toLocaleDateString('es-CO',{day:'2-digit',month:'short'}):'â€”';
    const created=u.createdAt?new Date(u.createdAt).toLocaleDateString('es-CO',{day:'2-digit',month:'short'}):'â€”';
    const statusBadge=u.isAdmin?'<span class="badge badge-purple">Admin</span>':
      pct>=80?'<span class="badge badge-green">Activo</span>':
      u.hasRoutine?'<span class="badge badge-blue">En progreso</span>':
      '<span class="badge" style="background:var(--panel);color:var(--text-muted);border:1px solid var(--border)">Sin rutina</span>';
    tbody.innerHTML+=`
      <tr>
        <td><strong>${u.name}</strong></td>
        <td style="color:var(--text-muted)">${u.email}</td>
        <td style="color:var(--text-muted)">${created}</td>
        <td style="color:var(--text-muted);font-size:0.8rem">${u.routineTitle||'â€”'}</td>
        <td>
          <div style="display:flex;align-items:center;gap:0.5rem">
            <div class="prog-track" style="width:70px"><div class="prog-fill" style="width:${pct}%;background:${progColor}"></div></div>
            <span style="font-size:0.78rem;color:${progColor};font-weight:600">${pct}%</span>
          </div>
        </td>
        <td style="color:var(--text-muted)">${lastActive}</td>
        <td>${statusBadge}</td>
      </tr>`;
  });
}

function filterAdminTable(){
  const q=document.getElementById('admin-search-input').value.toLowerCase();
  const filtered=adminUsers.filter(u=>u.name.toLowerCase().includes(q)||u.email.toLowerCase().includes(q));
  renderAdminTable(filtered);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BLOG ARTICLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const blogs = {
  physical:{
    title:'Por quÃ© el ejercicio es el mejor potenciador del rendimiento acadÃ©mico',
    cat:'Salud FÃ­sica',catClass:'badge-blue',
    content:`
      <p>Cuando hablamos de rendir mejor en el colegio, la mayorÃ­a piensa en estudiar mÃ¡s horas. Pero la neurociencia tiene algo diferente que decir.</p>
      <h3 style="color:var(--blue);margin:1.5rem 0 0.75rem">El BDNF: el fertilizante del cerebro</h3>
      <p>El ejercicio aerÃ³bico â€” caminar rÃ¡pido, trotar, nadar, bailar â€” libera una proteÃ­na llamada BDNF (Factor NeurotrÃ³fico Derivado del Cerebro). Esta proteÃ­na favorece la creaciÃ³n de nuevas conexiones neuronales, especialmente en el hipocampo, la regiÃ³n cerebral responsable de la memoria y el aprendizaje. Estudios de la Universidad de Harvard muestran que el BDNF sube significativamente despuÃ©s de 20 minutos de actividad moderada y sus efectos duran hasta 3 horas.</p>
      <h3 style="color:var(--blue);margin:1.5rem 0 0.75rem">QuÃ© dice la evidencia</h3>
      <p>Un meta-anÃ¡lisis de mÃ¡s de 200 estudios publicado en el British Journal of Sports Medicine encontrÃ³ que estudiantes fÃ­sicamente activos obtienen mejores calificaciones, tienen mayor capacidad de atenciÃ³n sostenida y muestran mejor regulaciÃ³n emocional. No se necesita ser deportista de Ã©lite: 20-30 minutos de actividad moderada, 3-4 veces por semana, ya produce mejoras medibles.</p>
      <h3 style="color:var(--blue);margin:1.5rem 0 0.75rem">CÃ³mo aplicarlo en tu vida</h3>
      <p>No necesitas un gimnasio. Caminar 20 minutos antes de estudiar, hacer una rutina corta de movilidad articular al levantarte, o simplemente tomar las escaleras en vez del ascensor ya activa los mecanismos neurobiolÃ³gicos que mejoran tu capacidad de aprender.</p>
    `
  },
  mental:{
    title:'GestiÃ³n del estrÃ©s acadÃ©mico: quÃ© funciona realmente',
    cat:'Salud Mental',catClass:'badge-purple',
    content:`
      <p>El estrÃ©s acadÃ©mico en grado 11 alcanza su punto mÃ¡ximo: ICFES, elecciÃ³n de carrera, presiÃ³n familiar, redes sociales. Pero el estrÃ©s crÃ³nico no es solo incomodidad â€” tiene consecuencias neurobiolÃ³gicas reales.</p>
      <h3 style="color:var(--purple-light);margin:1.5rem 0 0.75rem">Lo que el estrÃ©s le hace a tu cerebro</h3>
      <p>Cuando el estrÃ©s es sostenido, el cortisol (hormona del estrÃ©s) daÃ±a las neuronas del hipocampo, reduciendo literalmente tu capacidad de memorizar. AdemÃ¡s, activa la amÃ­gdala (el centro del miedo) en detrimento de la corteza prefrontal, que es donde reside el pensamiento lÃ³gico y la toma de decisiones.</p>
      <h3 style="color:var(--purple-light);margin:1.5rem 0 0.75rem">TÃ©cnicas basadas en evidencia</h3>
      <p>La respiraciÃ³n diafragmÃ¡tica (inhalar 4 seg, sostener 4, exhalar 6) activa el nervio vago y reduce el cortisol en minutos. El mindfulness de atenciÃ³n plena, practicado 10 minutos diarios, muestra reducciones del 30-40% en ansiedad segÃºn estudios del MIT. La escritura expresiva â€” escribir sobre lo que te preocupa durante 15 minutos â€” reduce la carga cognitiva del estrÃ©s y libera recursos mentales para el aprendizaje.</p>
      <h3 style="color:var(--purple-light);margin:1.5rem 0 0.75rem">Lo que NO funciona</h3>
      <p>Ignorar el estrÃ©s, distraerte con redes sociales (el scroll en realidad aumenta la ansiedad) o el exceso de cafeÃ­na. Estas estrategias dan alivio inmediato pero amplifican el problema a largo plazo.</p>
    `
  },
  sleep:{
    title:'El sueÃ±o: el entrenamiento invisible que estÃ¡s perdiendo',
    cat:'RecuperaciÃ³n',catClass:'badge-green',
    content:`
      <p>Si te quedas estudiando hasta las 2 AM creyendo que asÃ­ retendrÃ¡s mÃ¡s, la neurociencia te tiene malas noticias.</p>
      <h3 style="color:var(--green);margin:1.5rem 0 0.75rem">QuÃ© pasa mientras duermes</h3>
      <p>Durante el sueÃ±o de ondas lentas (fases 3 y 4), el cerebro transfiere la informaciÃ³n del dÃ­a de la memoria a corto plazo al almacenamiento de largo plazo. En el sueÃ±o REM, consolida habilidades motoras y conexiones emocionales. Dormir menos de 7 horas reduce este proceso en hasta un 40%, segÃºn el neurocientÃ­fico Matthew Walker (Universidad de Berkeley).</p>
      <h3 style="color:var(--green);margin:1.5rem 0 0.75rem">El efecto en el rendimiento</h3>
      <p>Operar con dÃ©ficit de sueÃ±o equivale cognitivamente a estar levemente intoxicado. La velocidad de procesamiento, la memoria de trabajo y la regulaciÃ³n emocional se deterioran. IrÃ³nicamente, estudiar cansado es mucho menos eficiente que descansar y estudiar 2 horas menos pero bien dormido.</p>
      <h3 style="color:var(--green);margin:1.5rem 0 0.75rem">Higiene del sueÃ±o prÃ¡ctica</h3>
      <p>MantÃ©n un horario constante (acostarte y levantarte a la misma hora, incluso fines de semana). Evita pantallas 45 minutos antes de dormir (la luz azul suprime la melatonina). MantÃ©n el cuarto fresco (18-20Â°C es la temperatura Ã³ptima para dormir). Una siesta de 20 minutos despuÃ©s del almuerzo puede recuperar el foco por el resto del dÃ­a.</p>
    `
  },
  nutrition:{
    title:'AlimentaciÃ³n e inteligencia: cÃ³mo lo que comes afecta tu mente',
    cat:'NutriciÃ³n',catClass:'badge-green',
    content:`
      <p>El cerebro es el Ã³rgano mÃ¡s demandante de tu cuerpo: consume el 20% de toda tu energÃ­a aunque representa solo el 2% de tu peso. Lo que comes literalmente construye el material de tus neuronas.</p>
      <h3 style="color:var(--green);margin:1.5rem 0 0.75rem">Glucosa y funciÃ³n cognitiva</h3>
      <p>El cerebro funciona principalmente con glucosa, pero no toda glucosa es igual. Los carbohidratos simples (azÃºcar, harinas refinadas) dan un pico de energÃ­a seguido de una caÃ­da que provoca fatiga mental. Los carbohidratos complejos (avena, frutas, leguminosas) mantienen niveles estables de glucosa, sosteniendo la concentraciÃ³n por mÃ¡s tiempo.</p>
      <h3 style="color:var(--green);margin:1.5rem 0 0.75rem">Omega-3 y neuroplasticidad</h3>
      <p>Los Ã¡cidos grasos omega-3 (presentes en nueces, atÃºn, sardinas, aguacate) son componentes estructurales de las membranas neuronales. Su consumo regular se asocia con mejor velocidad de procesamiento, mayor neuroplasticidad y reducciÃ³n de inflamaciÃ³n cerebral.</p>
      <h3 style="color:var(--green);margin:1.5rem 0 0.75rem">HidrataciÃ³n y cogniciÃ³n</h3>
      <p>Una deshidrataciÃ³n de apenas el 1-2% del peso corporal reduce la concentraciÃ³n y la memoria a corto plazo de manera medible. Beber 2 litros de agua al dÃ­a no es solo saludable â€” es cognitivamente necesario.</p>
    `
  },
  habits:{
    title:'La regla de los 21 dÃ­as y la ciencia real detrÃ¡s de los hÃ¡bitos',
    cat:'HÃ¡bitos',catClass:'badge-blue',
    content:`
      <p>Has escuchado que "un hÃ¡bito se forma en 21 dÃ­as". Esta cifra viene de observaciones anecdÃ³ticas de un cirujano plÃ¡stico en los aÃ±os 60. La ciencia actual dice algo muy diferente.</p>
      <h3 style="color:var(--blue);margin:1.5rem 0 0.75rem">El estudio real</h3>
      <p>Una investigaciÃ³n de University College London siguiÃ³ a 96 personas durante 12 semanas y encontrÃ³ que el tiempo para automatizar un comportamiento varÃ­a entre 18 y 254 dÃ­as, con un promedio de 66 dÃ­as. La duraciÃ³n depende del tipo de hÃ¡bito (beber agua es mÃ¡s fÃ¡cil que hacer ejercicio), de su consistencia y del contexto.</p>
      <h3 style="color:var(--blue);margin:1.5rem 0 0.75rem">CÃ³mo funciona la formaciÃ³n de hÃ¡bitos</h3>
      <p>El neurocientÃ­fico Ann Graybiel (MIT) identificÃ³ el bucle del hÃ¡bito: SeÃ±al â†’ Rutina â†’ Recompensa. Para instalar un hÃ¡bito, necesitas una seÃ±al consistente (la misma hora, el mismo lugar), una rutina clara y una recompensa inmediata. El secreto es hacer el comportamiento lo mÃ¡s pequeÃ±o y automÃ¡tico posible al inicio.</p>
      <h3 style="color:var(--blue);margin:1.5rem 0 0.75rem">Estrategias que funcionan</h3>
      <p>El "empaquetamiento de hÃ¡bitos" (combinar uno nuevo con uno establecido: "despuÃ©s de desayunar, hago 5 minutos de respiraciÃ³n") acelera la automatizaciÃ³n. La reducciÃ³n de fricciÃ³n (tener la ropa deportiva lista la noche anterior) elimina el esfuerzo de decisiÃ³n. Y el seguimiento del progreso activa el circuito de dopamina, motivÃ¡ndote a continuar.</p>
    `
  },
  anxiety:{
    title:'Ansiedad precompetitiva: cÃ³mo convertirla en combustible',
    cat:'PsicologÃ­a del Deporte',catClass:'badge-purple',
    content:`
      <p>Los nervios antes de un examen importante o una presentaciÃ³n no son una seÃ±al de debilidad â€” son tu sistema nervioso preparÃ¡ndote para dar lo mejor.</p>
      <h3 style="color:var(--purple-light);margin:1.5rem 0 0.75rem">La diferencia entre ansiedad y activaciÃ³n</h3>
      <p>FisiolÃ³gicamente, la ansiedad y la emociÃ³n positiva tienen las mismas seÃ±ales corporales: corazÃ³n acelerado, adrenalina, sudoraciÃ³n. La diferencia estÃ¡ en la interpretaciÃ³n. El psicÃ³logo Alison Wood Brooks (Harvard) demostrÃ³ que decirte a ti mismo "estoy emocionado" en vez de "estoy nervioso" mejora el rendimiento en tareas cognitivas y oratorias.</p>
      <h3 style="color:var(--purple-light);margin:1.5rem 0 0.75rem">La zona Ã³ptima de activaciÃ³n</h3>
      <p>La psicologÃ­a del deporte habla de la "zona de flujo Ã³ptimo": un nivel de activaciÃ³n ni demasiado bajo (aburrimiento, poca energÃ­a) ni demasiado alto (pÃ¡nico, bloqueo). Los atletas de Ã©lite aprenden a regular su activaciÃ³n para mantenerse en esa zona. TÃ©cnicas como la respiraciÃ³n controlada, el habla interna positiva y las rutinas precompetitivas sirven exactamente para eso.</p>
      <h3 style="color:var(--purple-light);margin:1.5rem 0 0.75rem">TÃ©cnicas concretas</h3>
      <p>La "tÃ©cnica del reencuadre": reinterpreta fÃ­sicamente los sÃ­ntomas de ansiedad como preparaciÃ³n. El "proceso focus": concentra tu atenciÃ³n en lo que puedes controlar (preparaciÃ³n, actitud, proceso) y no en el resultado. La visualizaciÃ³n: imagÃ­nate ejecutando correctamente paso a paso, no solo el resultado final.</p>
    `
  }
};

function openBlog(key){
  const b=blogs[key];
  if(!b)return;
  document.getElementById('blog-content').innerHTML=`
    <span class="badge ${b.catClass}" style="margin-bottom:1rem;display:inline-flex">${b.cat}</span>
    <h1 style="font-family:'Syne',sans-serif;font-weight:800;font-size:clamp(1.6rem,3.5vw,2.5rem);color:var(--text);line-height:1.15;margin-bottom:1.5rem">${b.title}</h1>
    <div style="font-size:0.95rem;color:var(--text-muted);line-height:1.85">${b.content}</div>
    <div style="margin-top:2rem;padding:1rem;background:rgba(255,71,87,0.06);border:1px solid rgba(255,71,87,0.2);border-radius:10px;font-size:0.78rem;color:rgba(232,240,254,0.55)">
      <strong style="color:var(--red)">Nota:</strong> Esta informaciÃ³n es de carÃ¡cter educativo general. Para diagnÃ³stico o tratamiento de condiciones especÃ­ficas, consulta a un profesional de la salud.
    </div>`;
  showScreen('blog');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FALLBACK ROUTINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getFallback(){
  return {
    titulo:'SEMANA DE FUNDAMENTOS',
    meta_semana:'Construir hÃ¡bitos base de movimiento, recuperaciÃ³n y gestiÃ³n mental',
    cita:{texto:'El cuerpo logra lo que la mente cree posible.',fuente:'Kenneth Cooper â€” Padre de la aerÃ³bica'},
    dias:[
      {nombre:'Lunes',enfoque:'ActivaciÃ³n y EnergÃ­a',actividades:[
        {tipo:'fisica',nombre:'Caminata de activaciÃ³n',descripcion:'Camina 15 minutos a ritmo moderado sin audÃ­fonos. Presta atenciÃ³n a tu respiraciÃ³n y a los sonidos del entorno. Ideal para empezar la semana con energÃ­a.',duracion:'15 min',icono:'ğŸš¶'},
        {tipo:'fisica',nombre:'Movilidad articular',descripcion:'Haz cÃ­rculos suaves con hombros, muÃ±ecas, cadera y tobillos (10 cada direcciÃ³n). Activa tus articulaciones sin impacto ni rebotes.',duracion:'8 min',icono:'ğŸ”„'},
        {tipo:'psicologica',nombre:'IntenciÃ³n del dÃ­a',descripcion:'Escribe en papel una meta concreta para hoy. No una lista â€” una sola cosa prioritaria. LÃ©ela en voz alta antes de empezar el dÃ­a.',duracion:'5 min',icono:'ğŸ“'},
        {tipo:'recuperacion',nombre:'RespiraciÃ³n 4-6-8',descripcion:'Inhala 4 seg, sostÃ©n 4, exhala 6. Repite 6 veces. Activa el sistema nervioso parasimpÃ¡tico y reduce el cortisol en sangre.',duracion:'5 min',icono:'ğŸŒ¬ï¸'}
      ]},
      {nombre:'Martes',enfoque:'Fuerza y Foco',actividades:[
        {tipo:'fisica',nombre:'Cardio suave 20 min',descripcion:'Sube y baja escaleras durante 10 min, o trota en el lugar a ritmo cÃ³modo. MantÃ©n una intensidad donde puedas hablar sin ahogarte.',duracion:'20 min',icono:'ğŸƒ'},
        {tipo:'fisica',nombre:'Fuerza corporal bÃ¡sica',descripcion:'3 series: 10 sentadillas, 8 flexiones de pared, 15 seg de plancha. Descansa 45 seg entre series. Sin impacto, sin equipamiento.',duracion:'15 min',icono:'ğŸ’ª'},
        {tipo:'psicologica',nombre:'TÃ©cnica Pomodoro',descripcion:'25 minutos de estudio en silencio absoluto, 5 de descanso activo (muÃ©vete, no pantallas). Repite 2-3 ciclos. Registra quÃ© lograste.',duracion:'60 min',icono:'â±ï¸'}
      ]},
      {nombre:'MiÃ©rcoles',enfoque:'RecuperaciÃ³n Activa',actividades:[
        {tipo:'recuperacion',nombre:'Estiramientos guiados',descripcion:'Estira isquiotibiales (pie apoyado, tronco hacia adelante 30 seg), cuÃ¡driceps, pectoral y cuello. Sin rebotes. Respira en cada posiciÃ³n.',duracion:'15 min',icono:'ğŸ§˜'},
        {tipo:'psicologica',nombre:'Diario de emociones',descripcion:'Escribe 5 minutos lo que has sentido esta semana. No edites, no juzgues â€” solo exprÃ©sate. La escritura expresiva reduce carga cognitiva.',duracion:'5 min',icono:'ğŸ“–'},
        {tipo:'recuperacion',nombre:'Higiene del sueÃ±o',descripcion:'Hoy, apaga pantallas 45 min antes de dormir. Lee algo que disfrutes o escucha mÃºsica tranquila. Observa si tardas menos en dormirte.',duracion:'45 min',icono:'ğŸ˜´'}
      ]},
      {nombre:'Jueves',enfoque:'Mente Aguda',actividades:[
        {tipo:'psicologica',nombre:'Mindfulness 5 sentidos',descripcion:'SiÃ©ntate 5 min: nombra 5 cosas que ves, 4 que escuchas, 3 que tocas, 2 que hueles, 1 que saboreas. Ancla tu mente al presente.',duracion:'7 min',icono:'ğŸ§ '},
        {tipo:'fisica',nombre:'Caminata activa 20 min',descripcion:'Camina rÃ¡pido (ritmo que eleve levemente el pulso) por 20 min. Alterna entre 2 min normal y 1 min rÃ¡pido. Este patrÃ³n potencia los beneficios cognitivos.',duracion:'20 min',icono:'âš¡'},
        {tipo:'psicologica',nombre:'PlanificaciÃ³n semanal',descripcion:'Revisa tu semana: Â¿quÃ© queda pendiente? Prioriza 3 tareas clave para los prÃ³ximos dÃ­as. La gestiÃ³n del tiempo reduce ansiedad y mejora el rendimiento.',duracion:'10 min',icono:'ğŸ“Š'}
      ]},
      {nombre:'Viernes',enfoque:'Disfrute y Bienestar',actividades:[
        {tipo:'fisica',nombre:'Actividad fÃ­sica libre',descripcion:'Haz la actividad que mÃ¡s disfrutes: bailar, jugar, montar bicicleta, nadar. El objetivo es el disfrute â€” el movimiento placentero tambiÃ©n cuenta.',duracion:'25 min',icono:'ğŸ‰'},
        {tipo:'psicologica',nombre:'Tiempo sin pantallas',descripcion:'Durante 1 hora, sin celular ni computador. Habla con alguien, dibuja, cocina, lee un libro fÃ­sico. El cerebro necesita ese descanso real.',duracion:'60 min',icono:'ğŸ“µ'},
        {tipo:'recuperacion',nombre:'Gratitud cientÃ­fica',descripcion:'Escribe 3 cosas especÃ­ficas por las que estÃ¡s agradecido hoy. La prÃ¡ctica de gratitud activa circuitos de dopamina y mejora el estado de Ã¡nimo mediblemente.',duracion:'5 min',icono:'ğŸŒŸ'}
      ]},
      {nombre:'SÃ¡bado',enfoque:'Cuerpo y Naturaleza',actividades:[
        {tipo:'fisica',nombre:'Salida activa al aire libre',descripcion:'30 min de actividad al aire libre: parque, cerros, ciclovÃ­a. La exposiciÃ³n a espacios naturales reduce el cortisol y mejora la funciÃ³n cognitiva.',duracion:'30 min',icono:'ğŸŒ³'},
        {tipo:'recuperacion',nombre:'Yoga restaurativo',descripcion:'Busca en YouTube "yoga restaurativo principiantes 15 minutos". Posturas pasivas que relajan el sistema nervioso sin esfuerzo muscular.',duracion:'15 min',icono:'ğŸ§˜'},
        {tipo:'psicologica',nombre:'ConexiÃ³n social real',descripcion:'Comparte tiempo de calidad con alguien: una conversaciÃ³n sin telÃ©fonos. Las conexiones sociales son el predictor mÃ¡s robusto de bienestar psicolÃ³gico.',duracion:'30 min',icono:'ğŸ¤'}
      ]},
      {nombre:'Domingo',enfoque:'ReflexiÃ³n y Carga',actividades:[
        {tipo:'psicologica',nombre:'Balance semanal',descripcion:'Escribe: quÃ© lograste esta semana, quÃ© aprendiste, quÃ© quieres ajustar la prÃ³xima. SÃ© honesto y compasivo contigo mismo. Sin juicio.',duracion:'10 min',icono:'ğŸ“Š'},
        {tipo:'fisica',nombre:'Actividad de recuperaciÃ³n',descripcion:'15 min de estiramientos suaves o caminata tranquila. El domingo no es para entrenar fuerte â€” es para preparar al cuerpo para la semana.',duracion:'15 min',icono:'ğŸŒ¿'},
        {tipo:'recuperacion',nombre:'SueÃ±o prioritario',descripcion:'AcuÃ©state a una hora que te permita dormir 8-9 horas antes del lunes. La mejor preparaciÃ³n para una semana de alto rendimiento es un domingo bien descansado.',duracion:'8-9 h',icono:'ğŸ˜´'}
      ]}
    ]
  };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function init(){
  const savedSession = await stGet('apex-session');
  if(savedSession && savedSession.uid){
    const userData = await stGet('user-'+savedSession.uid, true);
    if(userData){
      session.user = {uid:savedSession.uid,name:userData.name,email:userData.email,isAdmin:userData.isAdmin||false};
      await loadUserState();
      updateTopbar();
      if(appState.routine) renderRoutine();
    }
  }
}

init();
</script>
</body>
</html>
